{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/layers/TileLayer.js","webpack:///./node_modules/@arcgis/core/renderers/visualVariables/support/sizeVariableUtils.js","webpack:///./node_modules/@arcgis/core/layers/support/Tilemap.js","webpack:///./node_modules/@arcgis/core/layers/support/TilemapCache.js","webpack:///./node_modules/@arcgis/core/renderers/support/lengthUtils.js","webpack:///./node_modules/@arcgis/core/layers/support/serviceTileInfoProperty.js","webpack:///./node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js","webpack:///./node_modules/@arcgis/core/renderers/visualVariables/support/visualVariableUtils.js"],"names":["M","N","e","super","this","listMode","isReference","operationalLayerType","resampling","sourceJSON","spatialReference","path","sublayers","type","url","r","t","signal","addResolvingPromise","loadFromPortal","supportedTypes","then","_fetchService","parsedUrl","toLowerCase","_getDefaultAttribution","_getMapName","tileInfo","fromJSON","s","loaded","o","slice","reverse","flatten","toArray","i","a","writeSublayerStructure","forEach","write","push","some","Object","keys","length","layers","_getDefaultTileServers","Array","isArray","map","timestamp","getTileUrl","l","responseType","query","_ts","data","tilemapCache","supportsBlankTile","blankTile","customParameters","tileServers","bandCount","pixelSizeX","serverType","f","ssl","replace","read","origin","version","_fetchServerVersion","currentVersion","catch","match","indexOf","search","readOnly","dependsOn","prototype","Boolean","json","enabled","overridePolicy","String","origins","P","n","declaredClass","isNaN","isFinite","valueExpression","field","valueUnit","stops","minSize","maxSize","minDataValue","maxDataValue","location","left","top","width","height","_allAvailability","byteSize","_tileAvailabilityBitSet","Math","ceil","Uint8Array","service","request","row","col","h","c","m","d","details","httpStatus","valid","response","definition","validateJSON","freeze","_updateFromData","level","z","A","getLogger","L","_handles","_pendingTilemapRequests","_availableLevels","levels","cacheByteSize","_prefetchingEnabled","_tilemapCache","add","watch","_initializeTilemapDefinition","_initializeAvailableLevels","destroy","error","_tmpTilemapDefinition","_tilemapFromCache","fromDefinition","put","getAvailability","layer","updateTileInfo","upsampleTile","fetchTilemap","fetchAvailability","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","id","has","abort","remove","p","_prefetches","_maxPrefetch","removeUnordered","clear","size","get","hasTilemap","initialSize","constructOnly","Number","inches","feet","yards","miles","millimeters","centimeters","decimeters","meters","kilometers","radius","source","reader","minScale","maxScale","minLOD","maxLOD","ignoreMinMaxLOD","lods","filter","round","scale","arguments","copyright","capabilities","u","PI","visualVariables","warn","attributes","ipData","hasExpression","cache","v","compiledFunc","color","arcade","viewingMode","arcadeUtils","getViewInfo","createExecContext","createSyntaxTree","createFunction","executeFunction","b","normalizationField","parseFloat","g","blendColors","opacity","axis","rotationType","x","isScaleDriven","view","value","inputValueType","V","transformationType","shape","scaleBy","pow","sqrt","resolution","valueRepresentation","w","useSymbolValue"],"mappings":"gHAAA,qZAIqxD,MAAMA,EAAE,CAAC,8BAA8B,mCAAmC,+BAA+B,oCAAoC,4BAA4B,iCAAiC,yBAAyB,8BAA8B,gBAAgB,wCAAwC,kDAAkD,iCAAiC,gBAAgB,mBAAmB,kBAAkB,IAAIC,EAAE,cAAc,cAAD,CAAG,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,eAAE,oBAAe,eAAeC,GAAGC,SAASD,GAAGE,KAAKC,SAAS,OAAOD,KAAKE,YAAY,KAAKF,KAAKG,qBAAqB,6BAA6BH,KAAKI,YAAW,EAAGJ,KAAKK,WAAW,KAAKL,KAAKM,iBAAiB,KAAKN,KAAKO,KAAK,KAAKP,KAAKQ,UAAU,KAAKR,KAAKS,KAAK,OAAOT,KAAKU,IAAI,KAAK,kBAAkBZ,EAAEa,GAAG,MAAM,iBAAiBb,EAAE,CAACY,IAAIZ,KAAKa,GAAGb,EAAE,KAAKA,GAAG,MAAMc,EAAE,eAAEd,GAAGA,EAAEe,OAAO,KAAK,OAAOb,KAAKc,oBAAoBd,KAAKe,eAAe,CAACC,eAAe,CAAC,gBAAgBlB,GAAGmB,KAAK,IAAKjB,KAAKkB,cAAcN,GAAI,IAAKZ,KAAKkB,cAAcN,KAAM,eAAEZ,MAAM,yBAAyB,IAAIF,EAAE,MAAMa,EAAE,OAAOb,EAAEE,KAAKmB,gBAAW,EAAOrB,EAAES,KAAKa,cAAc,OAAOT,GAAGX,KAAKqB,uBAAuBrB,KAAKsB,YAAYX,IAAI,qBAAqBb,EAAEa,GAAG,OAAOb,EAAEA,GAAGa,EAAEY,UAAUZ,EAAEY,SAASjB,mBAAmB,OAAEkB,SAAS1B,GAAG,eAAeA,EAAEa,EAAEC,EAAEa,GAAG,IAAIzB,KAAK0B,SAAS5B,EAAE,OAAO,MAAM6B,EAAE7B,EAAE8B,QAAQC,UAAUC,QAAQ,EAAGtB,UAAUV,KAAKA,GAAGA,EAAEiC,UAAUF,WAAYE,UAAUC,EAAE,GAAGC,EAAE,CAACC,wBAAuB,KAAMT,GAAGE,EAAEQ,QAASrC,IAAI,MAAMa,EAAEb,EAAEsC,MAAM,GAAGH,GAAGD,EAAEK,KAAK1B,KAAMqB,EAAEM,KAAMxC,GAAGyC,OAAOC,KAAK1C,GAAG2C,OAAO,KAAM9B,EAAE+B,OAAOV,GAAG,kBAAkB,OAAOhC,KAAK2C,uBAAuB3C,KAAKmB,UAAUZ,MAAM,gBAAgBT,GAAG,OAAO8C,MAAMC,QAAQ/C,GAAGA,EAAEgD,IAAKhD,GAAG,eAAEA,GAAGS,MAAO,KAAK,UAAUT,EAAEa,EAAEC,EAAEa,EAAE,IAAI,MAAMZ,OAAOc,EAAEoB,UAAUf,GAAGP,EAAEQ,EAAEjC,KAAKgD,WAAWlD,EAAEa,EAAEC,GAAGqC,EAAE,CAACC,aAAa,QAAQrC,OAAOc,GAAG,OAAO,MAAMK,IAAIiB,EAAEE,MAAM,CAACC,IAAI3B,EAAEsB,YAAY,qBAAEd,EAAEgB,GAAGhC,KAAMnB,GAAGA,EAAEuD,MAAO,WAAWvD,EAAEa,EAAEC,GAAG,MAAMa,GAAGzB,KAAKsD,cAActD,KAAKuD,kBAAkB5B,EAAE,eAAE,IAAI3B,KAAKmB,UAAUgC,MAAMK,WAAW/B,GAAG,QAAQzB,KAAKyD,mBAAmBzB,EAAEhC,KAAK0D,YAAY,MAAM,GAAG1B,GAAGA,EAAES,OAAOT,EAAErB,EAAEqB,EAAES,QAAQzC,KAAKmB,UAAUZ,aAAaT,KAAKa,KAAKC,IAAIe,EAAE,IAAIA,EAAE,KAAK,cAAc7B,GAAG,OAAO,eAAE,CAAEc,EAAEa,KAAK,GAAGzB,KAAKK,WAAW,CAAC,GAAG,MAAML,KAAKK,WAAWsD,WAAW,MAAM3D,KAAKK,WAAWuD,WAAW,MAAM,IAAI,OAAE,6BAA6B,sDAAsD,YAAYhD,EAAE,CAACyC,KAAKrD,KAAKK,aAAa,IAAIL,KAAKmB,UAAU,MAAM,IAAI,OAAE,2BAA2B,8BAA8B,MAAMQ,EAAE,eAAE3B,KAAKmB,UAAUZ,MAAM,GAAG,eAAEoB,IAAI,gBAAgBA,EAAEkC,WAAW,MAAM,IAAI,OAAE,6BAA6B,sDAAsD,qBAAE7D,KAAKmB,UAAUZ,KAAK,CAAC4C,MAAM,CAACW,EAAE,UAAU9D,KAAKmB,UAAUgC,SAASnD,KAAKyD,kBAAkBP,aAAa,OAAOrC,OAAOf,IAAImB,KAAKL,EAAEa,KAAMR,KAAMN,IAAI,GAAGA,EAAEoD,MAAM/D,KAAKU,IAAIV,KAAKU,IAAIsD,QAAQ,UAAU,WAAWhE,KAAKK,WAAWM,EAAE0C,KAAKrD,KAAKiE,KAAKtD,EAAE0C,KAAK,CAACa,OAAO,UAAUxD,IAAIV,KAAKmB,YAAY,OAAOnB,KAAKmE,UAAU,eAAEnE,KAAKU,KAAK,OAAOV,KAAKoE,oBAAoBpE,KAAKU,IAAIZ,GAAGmB,KAAMnB,IAAIE,KAAKiE,KAAK,CAACI,eAAevE,MAAOwE,MAAM,UAAa,oBAAoBxE,EAAEa,GAAG,IAAI,eAAEb,GAAG,OAAO,iBAAI,MAAMc,EAAEd,EAAEkE,QAAQ,kBAAkB,MAAM,QAAQ,OAAO,qBAAEpD,EAAE,CAACuC,MAAM,CAACW,EAAE,UAAU9D,KAAKyD,kBAAkBP,aAAa,OAAOrC,OAAOF,IAAIM,KAAMnB,IAAI,GAAGA,EAAEuD,MAAMvD,EAAEuD,KAAKgB,eAAe,OAAOvE,EAAEuD,KAAKgB,eAAe,MAAM,IAAI,OAAE,sCAAuC,YAAYvE,GAAG,MAAMa,EAAEb,EAAEyE,MAAM,gKAAgK,OAAO5D,GAAGA,EAAE,GAAG,uBAAuBb,GAAG,IAAIA,EAAE,OAAO,IAAIa,EAAEb,EAAEA,EAAEsB,cAAc,IAAI,IAAIR,EAAE,EAAEa,EAAE7B,EAAE6C,OAAO7B,EAAEa,EAAEb,IAAI,GAAGD,EAAEf,EAAEgB,GAAGD,EAAES,cAAcoD,QAAQ1E,IAAI,EAAE,OAAO,eAAE,mCAAmCa,GAAG,uBAAuBb,GAAG,MAAMa,GAAG,IAAIb,EAAE2E,OAAO,+CAA+C7D,GAAG,IAAId,EAAE2E,OAAO,iDAAiD,OAAO9D,GAAGC,EAAE,CAACd,EAAEA,EAAEkE,QAAQrD,EAAE,wBAAwB,0BAA0BA,EAAE,wBAAwB,wBAAwB,KAAK,eAAE,CAAC,eAAE,CAAC+D,UAAS,EAAGC,UAAU,CAAC,gBAAgB9E,EAAE+E,UAAU,qBAAqB,MAAM,eAAE,CAAC,eAAE,CAACnE,KAAK,CAAC,OAAO,OAAO,oBAAoBZ,EAAE+E,UAAU,gBAAW,GAAQ,eAAE,CAAC,eAAE,CAACnE,KAAKoE,QAAQC,KAAK,CAACb,MAAK,EAAG7B,MAAM,CAAC2C,SAAQ,EAAGC,eAAe,KAAI,CAAED,SAAQ,SAAUlF,EAAE+E,UAAU,mBAAc,GAAQ,eAAE,CAAC,eAAE,CAACF,UAAS,EAAGjE,KAAK,CAAC,iCAAiCZ,EAAE+E,UAAU,4BAAuB,GAAQ,eAAE,CAAC,eAAE,CAACnE,KAAKoE,WAAWhF,EAAE+E,UAAU,kBAAa,GAAQ,eAAE,CAAC,kBAAK/E,EAAE+E,UAAU,kBAAa,GAAQ,eAAE,CAAC,eAAE,CAACnE,KAAK,UAAKZ,EAAE+E,UAAU,wBAAmB,GAAQ,eAAE,CAAC,eAAE,mBAAmB,CAAC,mBAAmB,cAAc/E,EAAE+E,UAAU,uBAAuB,MAAM,eAAE,CAAC,eAAE,CAACnE,KAAKwE,OAAOH,KAAK,CAACI,QAAQ,CAAC,YAAY,CAACjB,MAAK,EAAG7B,OAAM,IAAK6B,MAAK,MAAOpE,EAAE+E,UAAU,YAAO,GAAQ,eAAE,CAAC,eAAE,CAACF,UAAS,KAAM7E,EAAE+E,UAAU,iBAAY,GAAQ,eAAE,CAAC,eAAE,YAAY,CAAClC,OAAO,CAACjC,KAAK,CAAC,YAAOZ,EAAE+E,UAAU,iBAAiB,MAAM,eAAE,CAAC,eAAE,CAACE,KAAK,CAACb,MAAK,EAAG7B,OAAM,MAAOvC,EAAE+E,UAAU,oBAAe,GAAQ,eAAE,CAAC,eAAE,CAACD,UAAU,CAAC,gBAAgB9E,EAAE+E,UAAU,cAAc,MAAM,eAAE,CAAC,eAAE,gBAAgB/E,EAAE+E,UAAU,kBAAkB,MAAM,eAAE,CAAC,eAAE,CAACF,UAAS,EAAGI,KAAK,CAACb,MAAK,MAAOpE,EAAE+E,UAAU,YAAO,GAAQ,eAAE,CAAC,eAAE,SAAI/E,EAAE+E,UAAU,WAAM,GAAQ/E,EAAE,eAAE,CAAC,eAAE,0BAA0BA,GAAG,IAAIsF,EAAEtF,EAAiB,gB,oCCA55N,SAASuF,EAAEA,GAAG,OAAOA,GAAG,gDAAgDA,EAAEC,cAAc,SAASvF,EAAEsF,GAAG,OAAO,MAAMA,IAAIE,MAAMF,IAAIG,SAASH,GAAG,SAASpD,EAAEoD,GAAG,OAAOA,EAAEI,gBAAgB,aAAaJ,EAAEK,OAAO,iBAAiBL,EAAEK,MAAM,QAAQ,UAAU,SAASxC,EAAEmC,EAAEtF,GAAG,MAAMmD,EAAEnD,GAAGkC,EAAEoD,GAAGnD,EAAEmD,EAAEM,WAAW,UAAU,MAAM,YAAYzC,EAAE,WAAWmC,EAAEO,MAAM,QAAQ,MAAMP,EAAEQ,SAAS,MAAMR,EAAES,SAAS,MAAMT,EAAEU,cAAc,MAAMV,EAAEW,aAAa,iBAAiB,YAAY9D,EAAE,MAAMmD,EAAEQ,SAAS,MAAMR,EAAEU,aAAaV,EAAEQ,SAASR,EAAEU,aAAa,eAAe,WAAW,WAAW,kBAJ9iB,yI,sTCIkK,MAAM,EAAE,cAAc9F,KAAKgG,SAAS,CAACC,KAAK,EAAEC,IAAI,EAAEC,MAAM,EAAEC,OAAO,GAAGpG,KAAKqG,iBAAiB,UAAUrG,KAAKsG,SAAS,GAAG,gBAAgB1F,EAAEoB,GAAG,GAAG,YAAYhC,KAAKqG,iBAAiB,OAAOrG,KAAKqG,iBAAiB,MAAMvG,GAAGc,EAAEZ,KAAKgG,SAASE,KAAKlG,KAAKgG,SAASG,OAAOnE,EAAEhC,KAAKgG,SAASC,MAAMhE,EAAEnC,EAAE,EAAEmD,EAAEnD,GAAG,EAAE6B,EAAE3B,KAAKuG,wBAAwB,OAAOtD,EAAE,GAAGA,EAAEtB,EAAEc,OAAO,UAAUd,EAAEsB,GAAG,GAAGhB,EAAE,YAAY,cAAc,gBAAgBrB,GAAG,MAAMoB,EAAEhC,KAAKgG,SAASG,MAAMrG,EAAEE,KAAKgG,SAASI,OAAO,IAAInE,GAAE,EAAGgB,GAAE,EAAG,MAAMtB,EAAE6E,KAAKC,KAAKzE,EAAElC,EAAE,GAAGsF,EAAE,IAAIsB,WAAW/E,GAAG,IAAIhB,EAAE,EAAE,IAAI,IAAIqB,EAAE,EAAEA,EAAEpB,EAAE6B,OAAOT,IAAI,CAAC,MAAMlC,EAAEkC,EAAE,EAAEpB,EAAEoB,IAAIiB,GAAE,EAAGmC,EAAEzE,IAAI,GAAGb,GAAGmC,GAAE,EAAG,IAAInC,KAAKa,EAAEsC,EAAEjD,KAAKqG,iBAAiB,cAAcpE,EAAEjC,KAAKqG,iBAAiB,aAAarG,KAAKqG,iBAAiB,UAAUrG,KAAKuG,wBAAwBnB,EAAEpF,KAAKsG,UAAUlB,EAAE3C,QAAQ,sBAAsB7B,EAAEe,GAAG,MAAMhB,EAAEC,EAAE+F,QAAQC,SAAS,cAAGC,IAAIpF,EAAEqF,IAAIC,EAAEZ,MAAMa,EAAEZ,OAAOa,GAAGrG,EAAEsG,EAAE,CAAC/D,MAAM,CAACW,EAAE,SAAS,OAAOnC,EAAEA,EAAE,IAAIuF,KAAKvF,GAAGuF,EAAEvG,EAAE,EAAEC,GAAGe,GAAGV,KAAML,GAAGA,EAAEyC,MAAOiB,MAAO1D,IAAI,GAAGA,GAAGA,EAAEuG,SAAS,MAAMvG,EAAEuG,QAAQC,WAAW,MAAM,CAACpB,SAAS,CAACE,IAAIzE,EAAEwE,KAAKc,EAAEZ,MAAMa,EAAEZ,OAAOa,GAAGI,OAAM,EAAGhE,KAAK,eAAE2D,EAAEC,EAAE,IAAI,MAAMrG,IAAKK,KAAML,IAAI,GAAGA,EAAEoF,WAAWpF,EAAEoF,SAASE,MAAMzE,GAAGb,EAAEoF,SAASC,OAAOc,GAAGnG,EAAEoF,SAASG,QAAQa,GAAGpG,EAAEoF,SAASI,SAASa,GAAG,MAAM,IAAI,OAAE,4BAA4B,yDAAyD,CAACK,SAAS1G,EAAE2G,WAAW,CAACrB,IAAIzE,EAAEwE,KAAKc,EAAEZ,MAAMa,EAAEZ,OAAOa,KAAK,OAAO,EAAEzF,SAASZ,KAAM,gBAAgBoB,GAAG,EAAEwF,aAAaxF,GAAG,MAAMlC,EAAE,IAAI,EAAE,OAAOA,EAAEkG,SAASzD,OAAOkF,OAAO,eAAEzF,EAAEgE,WAAWlG,EAAE4H,gBAAgB1F,EAAEqB,MAAMd,OAAOkF,OAAO3H,GAAG,oBAAoBc,GAAG,IAAIA,IAAIA,EAAEoF,SAAS,MAAM,IAAI,OAAE,2BAA2B,0CAA0C,IAAG,IAAKpF,EAAEyG,MAAM,MAAM,IAAI,OAAE,kBAAkB,0CAA0C,IAAIzG,EAAEyC,KAAK,MAAM,IAAI,OAAE,uBAAuB,sCAAsC,IAAIT,MAAMC,QAAQjC,EAAEyC,MAAM,MAAM,IAAI,OAAE,wBAAwB,oCAAoC,GAAGzC,EAAEyC,KAAKZ,SAAS7B,EAAEoF,SAASG,MAAMvF,EAAEoF,SAASI,OAAO,MAAM,IAAI,OAAE,wBAAwB,gEAAgE,SAAS,EAAExF,GAAG,MAAM,GAAGA,EAAE+G,SAAS/G,EAAEiG,OAAOjG,EAAEkG,OAAOlG,EAAEuF,SAASvF,EAAEwF,SAAS,SAAS,EAAExF,GAAG,IAAIoB,EAAE,GAAG,gBAAgBpB,EAAE+F,QAAQlG,KAAKuB,EAAE,GAAGpB,EAAE+F,QAAQjG,eAAeE,EAAE+G,SAAS/G,EAAEiG,OAAOjG,EAAEkG,OAAOlG,EAAEuF,SAASvF,EAAEwF,aAAa,CAAC,MAAMtG,EAAEc,EAAE+F,QAAQjD,YAAY1B,EAAE,GAAGlC,GAAGA,EAAE2C,OAAO3C,EAAEc,EAAEiG,IAAI/G,EAAE2C,QAAQ7B,EAAE+F,QAAQjG,eAAeE,EAAE+G,SAAS/G,EAAEiG,OAAOjG,EAAEkG,OAAOlG,EAAEuF,SAASvF,EAAEwF,SAAS,MAAMtG,EAAEc,EAAE+F,QAAQxD,MAAM,OAAOrD,IAAIkC,EAAE,GAAGA,KAAKlC,KAAKkC,EAAiB,ICAvkD4F,EAAE,MAAMC,EAAE,OAAEC,UAAU,oCAAoC,IAAIC,EAAEH,EAAE,cAAc,OAAE,YAAY9H,GAAGC,MAAMD,GAAGE,KAAKgI,SAAS,IAAI,OAAEhI,KAAKiI,wBAAwB,GAAGjI,KAAKkI,iBAAiB,GAAGlI,KAAKmI,OAAO,EAAEnI,KAAKoI,cAAc,QAAQpI,KAAK4G,QAAQ,aAAE5G,KAAKqI,qBAAoB,EAAG,aAAarI,KAAKsI,cAAc,IAAI,OAAEtI,KAAKoI,eAAepI,KAAKgI,SAASO,IAAI,CAACvI,KAAKwI,MAAM,CAAC,kBAAkB,sBAAsB,IAAKxI,KAAKyI,gCAAiC,eAAEzI,KAAK,sBAAuBF,GAAGE,KAAK0I,2BAA2B5I,IAAI,KAAME,KAAKyI,+BAA+B,UAAUzI,KAAKgI,WAAWhI,KAAKgI,SAASW,UAAU3I,KAAKgI,SAAS,MAAM,WAAWlI,GAAG,OAAOA,GAAG,GAAG+H,EAAEe,MAAM,4CAA4C9I,GAAG,GAAGA,EAAE,WAAW,OAAO,GAAGE,KAAKmI,OAAO,aAAarI,EAAEc,EAAEoB,EAAEiB,GAAG,IAAIjD,KAAKkI,iBAAiBpI,GAAG,OAAO,eAAE,IAAI,OAAE,kCAAkC,SAASA,oCAAoC,MAAMa,EAAEX,KAAK6I,sBAAsB5G,EAAEjC,KAAK8I,kBAAkBhJ,EAAEc,EAAEoB,EAAErB,GAAG,GAAGsB,EAAE,OAAO,eAAEA,GAAG,MAAMN,EAAEsB,GAAGA,EAAEpC,OAAO,OAAOoC,EAAE,IAAIA,EAAEpC,OAAO,MAAM,eAAE,CAAEf,EAAEc,KAAK,eAAEe,EAAE,IAAKf,EAAE,mBAAO,MAAMoB,EAAE,EAAErB,GAAG,IAAIc,EAAEzB,KAAKiI,wBAAwBjG,GAAG,IAAIP,EAAE,CAACA,EAAE,EAAEsH,eAAepI,EAAEsC,GAAGhC,KAAMnB,IAAIE,KAAKsI,cAAcU,IAAIhH,EAAElC,EAAEA,EAAEwG,UAAUxG,IAAK,MAAMA,EAAE,WAAWE,KAAKiI,wBAAwBjG,GAAGhC,KAAKiI,wBAAwBjG,GAAGP,EAAEA,EAAER,KAAKnB,EAAEA,GAAG2B,EAAER,KAAKnB,EAAEc,KAAM,gBAAgBd,EAAEc,EAAEoB,GAAG,IAAIhC,KAAKkI,iBAAiBpI,GAAG,MAAM,cAAc,MAAMmD,EAAEjD,KAAK8I,kBAAkBhJ,EAAEc,EAAEoB,EAAEhC,KAAK6I,uBAAuB,OAAO5F,EAAEA,EAAEgG,gBAAgBrI,EAAEoB,GAAG,UAAU,wBAAwBlC,EAAEc,EAAEoB,EAAEiB,GAAGA,EAAE0E,MAAM7H,EAAEmD,EAAE4D,IAAIjG,EAAEqC,EAAE6D,IAAI9E,EAAE,MAAMrB,EAAEX,KAAKkJ,MAAM3H,SAAS,IAAIZ,EAAEwI,eAAelG,KAAK,CAAC,MAAMnD,EAAEE,KAAKiJ,gBAAgBhG,EAAE0E,MAAM1E,EAAE4D,IAAI5D,EAAE6D,KAAK,GAAG,gBAAgBhH,EAAE,OAAOA,EAAE,IAAIa,EAAEyI,aAAanG,GAAG,MAAM,eAAe,kBAAkBnD,EAAEc,EAAEoB,EAAEiB,GAAG,OAAOjD,KAAKkI,iBAAiBpI,GAAGE,KAAKqJ,aAAavJ,EAAEc,EAAEoB,EAAEiB,GAAGqB,MAAOxE,GAAGA,GAAImB,KAAMgC,IAAI,GAAGA,aAAa,EAAE,CAAC,MAAMtC,EAAEsC,EAAEgG,gBAAgBrI,EAAEoB,GAAG,MAAM,gBAAgBrB,EAAE,eAAE,IAAI,OAAE,4BAA4B,wBAAwB,CAACgH,MAAM7H,EAAE+G,IAAIjG,EAAEkG,IAAI9E,KAAKrB,EAAE,GAAG,eAAEsC,GAAG,MAAMA,EAAE,MAAM,YAAa,eAAE,IAAI,OAAE,kCAAkC,SAASnD,oCAAoC,0BAA0BA,EAAEc,EAAEoB,EAAEiB,EAAEtC,GAAGsC,EAAE0E,MAAM7H,EAAEmD,EAAE4D,IAAIjG,EAAEqC,EAAE6D,IAAI9E,EAAE,MAAMP,EAAEzB,KAAKkJ,MAAM3H,SAASE,EAAE0H,eAAelG,GAAG,MAAMhB,EAAEjC,KAAKsJ,kBAAkBxJ,EAAEc,EAAEoB,EAAErB,GAAG2D,MAAOxE,IAAI,GAAG,eAAEA,GAAG,MAAMA,EAAE,GAAG2B,EAAE2H,aAAanG,GAAG,OAAOjD,KAAKuJ,0BAA0BtG,EAAE0E,MAAM1E,EAAE4D,IAAI5D,EAAE6D,IAAI7D,GAAG,MAAMnD,IAAK,OAAOE,KAAKwJ,mCAAmCvG,EAAEwG,GAAG3J,EAAEc,EAAEoB,EAAErB,EAAEsB,GAAGA,EAAE,yCAAyCnC,EAAEc,EAAEoB,EAAEiB,EAAEtC,EAAEc,GAAG,IAAIzB,KAAKqI,oBAAoB,OAAO,MAAMpG,EAAE,YAAYnC,EAAI,GAAGE,KAAKgI,SAAS0B,IAAIzH,GAAG,OAAO,MAAMN,EAAE,iBAAIF,EAAER,KAAK,IAAKU,EAAEgI,QAAS,IAAKhI,EAAEgI,SAAU,IAAIvE,GAAE,EAAG,MAAM2B,EAAE,CAAC,SAAS3B,IAAIA,GAAE,EAAGzD,EAAEgI,WAAW,GAAG3J,KAAKgI,SAASO,IAAIxB,EAAE9E,SAAS,eAAE,GAAGN,EAAEd,QAAQyD,MAAM,QAAUc,IAAIA,GAAE,EAAGpF,KAAKgI,SAAS4B,OAAO3H,IAAI,eAAEN,GAAG,OAAO,MAAMqF,EAAE,CAACyC,GAAG3J,EAAE6H,MAAM/G,EAAEiG,IAAI7E,EAAE8E,IAAI7D,GAAG4G,EAAE,IAAIlJ,EAAEE,OAAOc,EAAEd,QAAQoG,EAAEjH,KAAKkJ,MAAM3H,SAAS,IAAI,IAAIzB,EAAE,EAAE8H,EAAEkC,YAAYrH,OAAOmF,EAAEmC,cAAc9C,EAAEmC,aAAapC,KAAKlH,EAAE,CAAC,MAAMA,EAAEE,KAAKsJ,kBAAkBtC,EAAEW,MAAMX,EAAEH,IAAIG,EAAEF,IAAI+C,GAAGjC,EAAEkC,YAAYzH,KAAKvC,GAAG,MAAMc,EAAE,KAAKgH,EAAEkC,YAAYE,gBAAgBlK,IAAIA,EAAEmB,KAAKL,EAAEA,IAAI,+BAA+B,IAAIZ,KAAKkJ,MAAM/H,UAAU,OAAO,MAAMrB,EAAEE,KAAKkJ,MAAM/H,UAAUP,EAAEd,EAAEqD,MAAMnD,KAAKsI,cAAc2B,QAAQjK,KAAK6I,sBAAsB,CAAClC,QAAQ,CAACjG,IAAIZ,EAAES,KAAK4C,MAAMvC,EAAE,eAAEA,GAAG,KAAK8C,YAAY1D,KAAKkJ,MAAMxF,YAAYkD,QAAQ5G,KAAK4G,QAAQnG,KAAKT,KAAKkJ,MAAMzI,MAAM0F,MAAMnG,KAAKkK,KAAK9D,OAAOpG,KAAKkK,KAAKvC,MAAM,EAAEd,IAAI,EAAEC,IAAI,GAAG,kBAAkBhH,EAAEc,EAAEoB,EAAEiB,GAAGA,EAAE0E,MAAM7H,EAAEmD,EAAE4D,IAAIjG,EAAEA,EAAEZ,KAAKkK,KAAKjH,EAAE6D,IAAI9E,EAAEA,EAAEhC,KAAKkK,KAAK,MAAMvJ,EAAE,EAAEsC,GAAG,OAAOjD,KAAKsI,cAAc6B,IAAIxJ,GAAG,2BAA2Bb,GAAGE,KAAKkI,iBAAiB,GAAGpI,GAAGA,EAAEqC,QAASrC,GAAGE,KAAKkI,iBAAiBpI,EAAE6H,QAAO,GAAK,WAAW,MAAM7H,EAAEE,KAAK,MAAM,CAAC,yBAAyB,OAAOF,EAAEuI,qBAAqB,uBAAuBzH,GAAGd,EAAEuI,oBAAoBzH,GAAGwJ,WAAW,CAACxJ,EAAEoB,EAAEiB,MAAMnD,EAAEgJ,kBAAkBlI,EAAEoB,EAAEiB,EAAEnD,EAAE+I,0BAA0Bd,EAAEgC,aAAa,EAAEhC,EAAE+B,YAAY,IAAI,OAAE,CAACO,YAAYzC,EAAEmC,eAAe,eAAE,CAAC,eAAE,CAACO,eAAc,EAAG7J,KAAK8J,UAAUxC,EAAEnD,UAAU,cAAS,GAAQ,eAAE,CAAC,eAAE,WAAWmD,EAAEnD,UAAU,aAAa,MAAM,eAAE,CAAC,eAAE,CAACF,UAAS,EAAGC,UAAU,CAAC,UAAUlE,KAAK8J,UAAUxC,EAAEnD,UAAU,OAAO,MAAM,eAAE,CAAC,eAAE,CAAC0F,eAAc,EAAG7J,KAAK8J,UAAUxC,EAAEnD,UAAU,qBAAgB,GAAQ,eAAE,CAAC,eAAE,CAAC0F,eAAc,KAAMvC,EAAEnD,UAAU,aAAQ,GAAQ,eAAE,CAAC,eAAE,CAAC0F,eAAc,KAAMvC,EAAEnD,UAAU,eAAU,GAAQmD,EAAEH,EAAE,eAAE,CAAC,eAAE,qCAAqCG,I,oCCJ3vK,8DAIuI,MAAMd,EAAE,CAACuD,OAAO,eAAE,EAAE,SAAS,UAAUC,KAAK,eAAE,EAAE,SAAS,QAAQ,UAAU,eAAE,EAAE,SAAS,WAAWC,MAAM,eAAE,EAAE,SAAS,SAASC,MAAM,eAAE,EAAE,SAAS,SAAS,iBAAiB,eAAE,EAAE,SAAS,kBAAkBC,YAAY,eAAE,EAAE,SAAS,eAAeC,YAAY,eAAE,EAAE,SAAS,eAAeC,WAAW,eAAE,EAAE,SAAS,cAAcC,OAAO,eAAE,EAAE,SAAS,UAAUC,WAAW,eAAE,EAAE,SAAS,cAAc,kBAAkB,EAAE,eAAE,EAAE,SAAS,OAAEC,U,kCCJ/iB,oFAI6B,MAAMtK,EAAE,CAACF,KAAK,OAAEqE,KAAK,CAACI,QAAQ,CAACyB,QAAQ,CAAC1C,KAAK,CAACiH,OAAO,CAAC,WAAW,WAAW,WAAW,SAAS,UAAUC,OAAO/F,OAAO,SAASA,EAAEzE,EAAEyE,EAAEnC,EAAEtB,GAAG,IAAIhB,EAAE,OAAO,KAAK,MAAMyK,SAASpJ,EAAEqJ,SAASzK,EAAE0K,OAAOrE,EAAEsE,OAAO9J,GAAG2D,EAAE,GAAG,MAAM6B,GAAG,MAAMxF,EAAE,OAAOE,GAAGA,EAAE6J,gBAAgB,OAAEhK,SAASb,GAAG,OAAEa,SAAS,IAAIb,EAAE8K,KAAK9K,EAAE8K,KAAKC,OAAO,EAAG/D,MAAM7H,KAAK,MAAMA,GAAGA,GAAGmH,GAAGnH,GAAG2B,KAAM,GAAG,IAAIO,GAAG,IAAIpB,EAAE,CAAC,MAAMwE,EAAEtF,GAAG0G,KAAKmF,MAAM,IAAI7L,GAAG,IAAImD,EAAEjB,EAAEoD,EAAEpD,GAAG,IAAIL,EAAEf,EAAEwE,EAAExE,IAAG,IAAK,OAAO,OAAEY,SAAS,IAAIb,EAAE8K,KAAK9K,EAAE8K,KAAKC,OAAQ5L,IAAI,MAAMa,EAAEyE,EAAEtF,EAAE8L,OAAO,OAAOjL,GAAGsC,GAAGtC,GAAGgB,MAAO,OAAO,OAAEH,SAASb,K,kCCJ7iB,sMAI2rB,MAAMsB,EAAEA,IAAI,IAAIgB,EAAE,cAAchB,EAAE,cAAclC,SAAS8L,WAAW7L,KAAK8L,UAAU,KAAK9L,KAAKoL,SAAS,EAAEpL,KAAKqL,SAAS,EAAErL,KAAKM,iBAAiB,KAAKN,KAAKuB,SAAS,KAAKvB,KAAKsD,aAAa,KAAK,aAAaxD,EAAEa,GAAG,OAAO,MAAMA,EAAE2K,QAAQ,MAAM3K,EAAE4K,OAAOzL,EAAE,EAAE,aAAaA,EAAEa,GAAG,OAAO,MAAMA,EAAE2K,QAAQ,MAAM3K,EAAE4K,OAAOzL,EAAE,EAAE,wBAAwB,OAAOE,KAAKmE,SAAS,KAAK,iBAAiBrE,EAAEa,GAAG,OAAOA,EAAEoL,cAAcpL,EAAEoL,aAAavH,QAAQ,YAAY,EAAE,IAAI,OAAE,CAAC0E,MAAMlJ,OAAO,OAAO,OAAO,eAAE,CAAC,eAAE,CAAC8E,KAAK,CAACb,KAAK,CAACiH,OAAO,qBAAqBjI,EAAE2B,UAAU,iBAAY,GAAQ,eAAE,CAAC,kBAAK3B,EAAE2B,UAAU,gBAAW,GAAQ,eAAE,CAAC,eAAE,UAAU,aAAa3B,EAAE2B,UAAU,eAAe,MAAM,eAAE,CAAC,kBAAK3B,EAAE2B,UAAU,gBAAW,GAAQ,eAAE,CAAC,eAAE,UAAU,aAAa3B,EAAE2B,UAAU,eAAe,MAAM,eAAE,CAAC,eAAE,CAACnE,KAAK,UAAKwC,EAAE2B,UAAU,wBAAmB,GAAQ,eAAE,CAAC,eAAE,CAACF,UAAS,EAAGC,UAAU,CAAC,cAAc1B,EAAE2B,UAAU,oBAAoB,MAAM,eAAE,CAAC,eAAE,SAAI3B,EAAE2B,UAAU,gBAAW,GAAQ,eAAE,CAAC,kBAAK3B,EAAE2B,UAAU,oBAAe,GAAQ,eAAE,CAAC,eAAE,UAAU,eAAe,CAAC,kBAAkB3B,EAAE2B,UAAU,mBAAmB,MAAM,eAAE,CAAC,kBAAK3B,EAAE2B,UAAU,eAAU,GAAQ3B,EAAE,eAAE,CAAC,eAAE,2CAA2CA,GAAGA,I,kCCJxzD,sUAIuW,MAAM+D,EAAE,OAAEc,UAAU,8DAA8DkE,EAAE,IAAI,OAAElI,EAAE0C,KAAKyF,GAAGpC,EAAE,4CAA4C,SAAS3C,EAAEpH,EAAEa,EAAEqB,GAAG,MAAMoD,EAAE,oBAAoBtF,GAAGA,EAAEoM,gBAAgBpM,EAAEoM,gBAAgBR,OAAQ5L,GAAG,UAAUA,EAAEW,MAAO,GAAGX,EAAE,IAAIsF,EAAE,OAAO,GAAG,iDAAiDA,EAAEC,cAAc,YAAY2B,EAAEmF,KAAK,4FAA4F,MAAM1K,EAAE,iBAAiBd,EAAEgB,EAAEF,EAAE,KAAKd,EAAEsC,EAAEtB,GAAGA,EAAEyK,WAAW,IAAIJ,EAAEvK,EAAEd,EAAE,KAAK,MAAMmD,EAAEsB,EAAEK,OAAO4G,OAAOxC,EAAEyC,cAAcpF,GAAG9B,EAAEmH,MAAM,IAAIC,EAAEpH,EAAEmH,MAAME,aAAa,IAAI3I,IAAIoD,EAAE,CAAC,MAAMpH,EAAEsF,EAAEO,MAAM,OAAO7F,GAAGA,EAAE,IAAIA,EAAE,GAAG4M,MAAM,GAAG,iBAAiBV,EAAE,GAAG9E,EAAE,CAAC,IAAI,eAAElF,KAAK,eAAEA,EAAE2K,QAAQ,YAAY3F,EAAE4B,MAAM,wDAAwD,MAAM9I,EAAE,CAAC8M,YAAY5K,EAAE4K,YAAYhB,MAAM5J,EAAE4J,MAAMtL,iBAAiB0B,EAAE1B,kBAAkBK,EAAEqB,EAAE2K,OAAOE,YAAYjM,EAAED,EAAEmM,YAAYhN,GAAG2B,EAAEd,EAAEoM,kBAAkBpL,EAAEf,GAAG,IAAI4L,EAAE,CAAC,MAAM1M,EAAEa,EAAEqM,iBAAiB5H,EAAEI,iBAAiBgH,EAAE7L,EAAEsM,eAAenN,GAAGsF,EAAEmH,MAAME,aAAaD,EAAER,EAAErL,EAAEuM,gBAAgBV,EAAE/K,QAAQwB,IAAI+I,EAAE/I,EAAEa,IAAI,MAAMqJ,EAAE/H,EAAEgI,mBAAmBrG,EAAE9D,EAAEoK,WAAWpK,EAAEkK,SAAI,EAAO,GAAG,MAAMnB,KAAKmB,GAAG1L,IAAI6D,MAAMyB,IAAI,IAAIA,GAAG,CAACzB,MAAMyB,IAAItF,IAAIuK,GAAGjF,GAAG,MAAMjH,EAAEwN,EAAEtB,EAAEnC,GAAG,GAAG/J,EAAE,CAAC,MAAMa,EAAEb,EAAE,GAAG2B,EAAE3B,EAAE,GAAG6B,EAAEhB,IAAIc,EAAE2D,EAAEO,MAAMhF,GAAG+L,MAAM,OAAEa,YAAYnI,EAAEO,MAAMhF,GAAG+L,MAAMtH,EAAEO,MAAMlE,GAAGiL,MAAM5M,EAAE,GAAG,eAAEkC,GAAGA,EAAE0K,WAAM,GAAQ,OAAO,IAAI,OAAE/K,KAAK,SAAS6K,EAAE1M,EAAEmC,EAAED,GAAG,MAAMpB,EAAE,oBAAoBd,GAAGA,EAAEoM,gBAAgBpM,EAAEoM,gBAAgBR,OAAQ5L,GAAG,YAAYA,EAAEW,MAAO,GAAGX,EAAE,IAAIc,EAAE,OAAO,GAAG,mDAAmDA,EAAEyE,cAAc,YAAY2B,EAAEmF,KAAK,8FAA8F,MAAM/G,EAAE,iBAAiBnD,EAAER,EAAE2D,EAAE,KAAKnD,EAAEN,EAAEF,GAAGA,EAAE2K,WAAW,IAAInJ,EAAEmC,EAAEnD,EAAE,KAAK,MAAM+J,EAAEpL,EAAE6E,OAAO4G,OAAOvI,EAAEwI,cAAczC,GAAGjJ,EAAE2L,MAAM,IAAIrF,EAAEtG,EAAE2L,MAAME,aAAa,IAAIT,IAAInC,EAAE,CAAC,MAAM/J,EAAEc,EAAE+E,MAAM,OAAO7F,GAAGA,EAAE,IAAIA,EAAE,GAAG0N,QAAQ,GAAG,iBAAiBvK,EAAE,GAAG4G,EAAE,CAAC,GAAG,eAAE7H,IAAI,eAAEA,EAAE2K,QAAQ,YAAY3F,EAAE4B,MAAM,wDAAwD,MAAM9I,EAAE,CAAC8M,YAAY5K,EAAE4K,YAAYhB,MAAM5J,EAAE4J,MAAMtL,iBAAiB0B,EAAE1B,kBAAkB2B,EAAED,EAAE2K,OAAOE,YAAYzH,EAAEnD,EAAE6K,YAAYhN,GAAG6B,EAAEM,EAAE8K,kBAAkBtL,EAAE2D,GAAG,IAAI8B,EAAE,CAAC,MAAMpH,EAAEmC,EAAE+K,iBAAiBpM,EAAE4E,iBAAiB0B,EAAEjF,EAAEgL,eAAenN,GAAGc,EAAE2L,MAAME,aAAavF,EAAEjE,EAAEhB,EAAEiL,gBAAgBhG,EAAEvF,QAAQA,IAAIsB,EAAEtB,EAAEqK,IAAI,MAAMQ,EAAE5L,EAAEwM,mBAAmBD,EAAExL,EAAE0L,WAAW1L,EAAE6K,SAAI,EAAO,GAAG,MAAMvJ,KAAKuJ,GAAGpH,IAAIE,MAAM6H,IAAI,IAAIA,GAAG,CAAC7H,MAAM6H,IAAI/H,IAAInC,GAAGkK,GAAG,MAAMrN,EAAEwN,EAAErK,EAAEa,GAAG,GAAGhE,EAAE,CAAC,MAAMmC,EAAEnC,EAAE,GAAGa,EAAEb,EAAE,GAAG,GAAGmC,IAAItB,EAAE,OAAOC,EAAE+E,MAAM1D,GAAGuL,QAAQ,CAAC,MAAMxL,EAAEpB,EAAE+E,MAAM1D,GAAGuL,QAAQ,OAAOxL,GAAGpB,EAAE+E,MAAMhF,GAAG6M,QAAQxL,GAAGlC,EAAE,MAAM,SAASqN,EAAErN,EAAEmC,EAAED,GAAG,MAAMpB,EAAE,oBAAoBd,GAAGA,EAAEoM,gBAAgBpM,EAAEoM,gBAAgBR,OAAQ5L,GAAG,aAAaA,EAAEW,MAAO,GAAGX,EAAE,IAAIc,EAAE,OAAO,GAAG,oDAAoDA,EAAEyE,cAAc,YAAY2B,EAAEmF,KAAK,+FAA+F,MAAM/G,EAAExE,EAAE6M,MAAM,UAAUhM,EAAE,YAAY2D,GAAG,eAAexE,EAAE8M,aAAa,GAAG,EAAE/L,EAAE,YAAYyD,GAAG,eAAexE,EAAE8M,cAAc,EAAE,EAAEzK,EAAE,iBAAiBhB,EAAE,KAAKA,EAAE+J,EAAE/I,GAAGA,EAAEmJ,WAAWtI,EAAElD,EAAE6E,OAAO6G,cAAczC,GAAGjJ,EAAE2L,MAAM,IAAIrF,EAAEtG,EAAE2L,MAAME,aAAaD,EAAE,EAAE,IAAI1I,IAAI+F,EAAE,OAAO2C,EAAE,GAAG3C,EAAE,CAAC,GAAG,eAAE7H,IAAI,eAAEA,EAAE2K,QAAQ,YAAY3F,EAAE4B,MAAM,wDAAwD,MAAM9I,EAAE,CAAC8M,YAAY5K,EAAE4K,YAAYhB,MAAM5J,EAAE4J,MAAMtL,iBAAiB0B,EAAE1B,kBAAkB2B,EAAED,EAAE2K,OAAOE,YAAYzH,EAAEnD,EAAE6K,YAAYhN,GAAG2B,EAAEQ,EAAE8K,kBAAkB9J,EAAEmC,GAAG,IAAI8B,EAAE,CAAC,MAAMpH,EAAEmC,EAAE+K,iBAAiBpM,EAAE4E,iBAAiB0B,EAAEjF,EAAEgL,eAAenN,GAAGc,EAAE2L,MAAME,aAAavF,EAAEsF,EAAEvK,EAAEiL,gBAAgBhG,EAAEzF,QAAQuK,IAAIQ,EAAER,EAAElI,IAAI,GAAG,OAAO0I,EAAE,iBAAiBA,GAAGlH,MAAMkH,GAAG,KAAK/K,EAAEE,EAAE6K,EAAEA,EAAE,SAASzF,EAAEjH,EAAEkC,EAAEpB,GAAG,MAAMwE,EAAE,oBAAoBtF,GAAGA,EAAEoM,gBAAgBpM,EAAEoM,gBAAgBR,OAAQ5L,GAAG,SAASA,EAAEW,MAAO,GAAGX,EAAE,IAAIsF,EAAE,OAAO,GAAG,gDAAgDA,EAAEC,cAAc,YAAY2B,EAAEmF,KAAK,2FAA2F,MAAM1K,EAAEkM,EAAE,SAAS7N,EAAEkC,EAAEpB,GAAG,MAAMwE,EAAE,iBAAiBpD,EAAEP,EAAE2D,EAAE,KAAKpD,EAAEL,EAAEF,GAAGA,EAAE2K,WAAW,IAAIJ,EAAE5G,EAAEpD,EAAE,KAAK,MAAM4L,cAAc9J,GAAGhE,EAAEyM,MAAM,IAAI1C,EAAE/J,EAAEyM,MAAME,aAAa,GAAG3I,EAAE,CAAC,MAAMnD,EAAE,eAAEC,GAAGA,EAAEgL,WAAM,EAAO5J,EAAE,eAAEpB,GAAGA,EAAEiN,UAAK,EAAO7B,EAAE,MAAMrL,GAAG,OAAOqB,EAAE,SAASlC,GAAG,IAAImC,EAAE,KAAKtB,EAAE,KAAK,MAAMqB,EAAElC,EAAE6F,MAAM,OAAO3D,GAAGC,EAAED,EAAE,GAAG8L,MAAMnN,EAAEqB,EAAEA,EAAES,OAAO,GAAGqL,QAAQ7L,EAAEnC,EAAEgG,cAAc,EAAEnF,EAAEb,EAAEiG,cAAc,IAAI9D,EAAEtB,GAAG,EAA5I,CAA+Ib,GAAGa,OAAO,IAAIyE,EAAE,OAAOtF,EAAEiO,gBAAgB,IAAI,aAAa,CAAC,GAAG,eAAEnN,IAAI,eAAEA,EAAE+L,QAAQ,YAAY3F,EAAE4B,MAAM,wDAAwD,MAAM3G,EAAE,CAAC2K,YAAYhM,EAAEgM,YAAYhB,MAAMhL,EAAEgL,MAAMtL,iBAAiBM,EAAEN,kBAAkB0B,EAAEpB,EAAE+L,OAAOE,YAAYzH,EAAEpD,EAAE8K,YAAY7K,GAAGN,EAAEK,EAAE+K,kBAAkBtL,EAAE2D,GAAG,IAAIyE,EAAE,CAAC,MAAM5H,EAAED,EAAEgL,iBAAiBlN,EAAE0F,iBAAiBqE,EAAE7H,EAAEiL,eAAehL,GAAGnC,EAAEyM,MAAME,aAAa5C,EAAEmC,EAAEhK,EAAEkL,gBAAgBrD,EAAElI,GAAG,MAAM,IAAI,QAAQA,IAAIqK,EAAErK,EAAE7B,EAAE2F,QAAQ,MAAM,IAAI,UAAUuG,EAAE,KAAK,IAAI,eAAEA,GAAG,OAAO,KAAK,GAAG5G,IAAItF,EAAEsN,mBAAmB,OAAOpB,EAAE,MAAM9E,EAAEvF,EAAE0L,WAAW1L,EAAE7B,EAAEsN,qBAAqB,KAAK,OAAO,eAAElG,IAAI,IAAIA,EAAE8E,EAAE9E,EAAE,KAAh+B,CAAs+B9B,EAAEpD,EAAEpB,GAAGwE,EAAEpD,EAAEpB,EAAEwE,EAAEmH,MAAMF,QAAQ,OAAO,MAAM5K,GAAG6D,MAAM7D,GAAG,EAAEA,EAAE,SAASwF,EAAEnH,EAAEmC,EAAEtB,GAAG,OAAO,MAAMb,EAAE,KAAK,eAAEA,GAAGiH,EAAEjH,EAAEmC,EAAEtB,GAAG,eAAEb,GAAGA,EAAE,KAAK,SAASkO,EAAElO,EAAEmC,EAAEtB,GAAG,OAAO,eAAEA,IAAIb,EAAEa,EAAEA,EAAE,eAAEsB,IAAInC,EAAEmC,EAAEA,EAAEnC,EAAE,SAAS6N,EAAE7N,EAAEa,EAAEqB,EAAEpB,EAAEwE,GAAG,OAAOzE,EAAEsN,oBAAoB,IAAI,WAAW,OAAO,SAASnO,EAAEmC,EAAEtB,EAAEqB,GAAG,OAAOlC,GAAGmH,EAAEhF,EAAE2D,QAAQjF,EAAEqB,IAAIC,EAAE6D,cAAhD,CAA+DhG,EAAEa,EAAEqB,EAAEpB,GAAG,IAAI,WAAW,OAAO,SAASd,EAAEmC,EAAEtB,GAAG,MAAMqB,EAAElC,EAAE6F,MAAM,IAAI/E,EAAEoB,GAAGA,EAAES,QAAQT,EAAE,GAAGkI,KAAK,OAAO,MAAMtJ,IAAIA,EAAEd,EAAE8F,SAASqB,EAAErG,EAAEqB,EAAEtB,GAAjG,CAAqGA,EAAEqB,EAAEpB,GAAG,IAAI,iBAAiB,OAAO,SAASd,EAAEa,EAAEqB,EAAEpB,GAAG,MAAMwE,GAAGtF,EAAEa,EAAEmF,eAAenF,EAAEoF,aAAapF,EAAEmF,cAAcrE,EAAEwF,EAAEtG,EAAEiF,QAAQ5D,EAAEpB,GAAGe,EAAEsF,EAAEtG,EAAEkF,QAAQ7D,EAAEpB,GAAGqC,EAAE,eAAErC,GAAGA,EAAEsN,WAAM,EAAO,GAAGpO,GAAGa,EAAEmF,aAAa,OAAOrE,EAAE,GAAG3B,GAAGa,EAAEoF,aAAa,OAAOpE,EAAE,GAAG,SAAShB,EAAEwN,SAASlL,EAAE,CAAC,MAAMnD,EAAE,WAAWmD,EAAEhB,EAAEnC,EAAEgE,EAAE0C,KAAK4H,IAAI3M,EAAE,EAAE,GAAGA,EAAEA,EAAEd,EAAEsB,EAAEmD,IAAItF,EAAEgE,EAAE0C,KAAK4H,IAAIzM,EAAE,EAAE,GAAGA,EAAEA,GAAGM,GAAG,OAAOnC,EAAE,EAAE0G,KAAK6H,KAAK1N,EAAEmD,GAAG0C,KAAK6H,KAAK1N,GAAG,OAAOc,EAAE2D,GAAGzD,EAAEF,GAAvW,CAA2W3B,EAAEa,EAAEqB,EAAEpB,GAAG,IAAI,eAAe,OAAO,SAASd,EAAEa,EAAEqB,EAAEpB,GAAG,MAAMwE,EAAE,eAAExE,GAAGA,EAAEsN,WAAM,EAAOzM,EAAE3B,EAAEa,EAAEmF,aAAanE,EAAEsF,EAAEtG,EAAEiF,QAAQ5D,EAAEpB,GAAGqC,EAAEgE,EAAEtG,EAAEkF,QAAQ7D,EAAEpB,GAAG,IAAIoG,EAAE,KAAK,OAAOA,EAAE,WAAW5B,EAAE,EAAEoB,KAAK6H,KAAK5M,EAAE+E,KAAK4H,IAAIzM,EAAE,EAAE,IAAI,WAAWyD,GAAG,YAAYA,GAAG,UAAUA,EAAEoB,KAAK6H,KAAK5M,EAAE+E,KAAK4H,IAAIzM,EAAE,IAAIF,EAAEE,EAAEqM,EAAEhH,EAAErF,EAAEsB,GAArP,CAAyPnD,EAAEa,EAAEqB,EAAEpB,GAAG,IAAI,QAAQ,OAAO,SAASd,EAAEmC,EAAEtB,EAAEqB,EAAEpB,GAAG,MAAMwE,EAAE3D,EAAEE,GAAG2L,EAAExN,EAAEc,GAAG,GAAGwE,IAAI3D,EAAE,OAAOwF,EAAEhF,EAAE0D,MAAMP,GAAG8E,KAAKvJ,EAAEqB,GAAG,CAAC,MAAMlC,EAAEmH,EAAEhF,EAAE0D,MAAMP,GAAG8E,KAAKvJ,EAAEqB,GAAG,OAAOlC,GAAGmH,EAAEhF,EAAE0D,MAAMlE,GAAGyI,KAAKvJ,EAAEqB,GAAGlC,GAAG6B,GAAnJ,CAAuJ7B,EAAEa,EAAEqB,EAAEpB,EAAEwE,GAAG,IAAI,kBAAkB,OAAO,SAAStF,EAAEa,EAAEqB,EAAEpB,GAAG,MAAMwE,GAAG,eAAExE,IAAIA,EAAE0N,WAAW1N,EAAE0N,WAAW,GAAG,OAAE3N,EAAE+E,WAAW/D,EAAEsF,EAAEtG,EAAEiF,QAAQ5D,EAAEpB,GAAGqC,EAAEgE,EAAEtG,EAAEkF,QAAQ7D,EAAEpB,IAAI2N,oBAAoBvH,GAAGrG,EAAE,IAAIqL,EAAE,KAAK,OAAOA,EAAE,SAAShF,EAAE,EAAER,KAAK6H,KAAKvO,EAAEgE,GAAGsB,EAAE,WAAW4B,GAAG,aAAaA,EAAE,EAAElH,EAAEsF,EAAEtF,EAAEsF,EAAE4I,EAAEhC,EAAErK,EAAEsB,GAA5O,CAAgPnD,EAAEa,EAAEqB,EAAEpB,GAAG,IAAI,WAAW,OAAOd,EAAE,IAAI,UAAU,OAAO,MAAM,SAAS0O,EAAE1O,EAAEmC,EAAEtB,GAAG,MAAMiN,cAAc5L,GAAGlC,EAAEyM,MAAM,KAAKvK,GAAG,OAAOrB,GAAGsB,GAAG,OAAO,KAAK,MAAMrB,EAAE,CAACgL,MAAM3J,EAAE4L,KAAKlN,GAAG,IAAIyE,EAAE6B,EAAEnH,EAAE8F,QAAQoG,EAAEpL,GAAGa,EAAEwF,EAAEnH,EAAE+F,QAAQmG,EAAEpL,GAAG,GAAG,MAAMwE,GAAG,MAAM3D,EAAE,CAAC,GAAG2D,EAAE3D,EAAE,CAAC,MAAM3B,EAAE2B,EAAEA,EAAE2D,EAAEA,EAAEtF,EAAE,MAAM,CAAC8F,QAAQR,EAAES,QAAQpE,IAAohB,SAAS6L,EAAExN,EAAEmC,GAAG,IAAIA,EAAE,OAAO,IAAItB,EAAE,EAAEqB,EAAEC,EAAEQ,OAAO,EAAE,OAAOR,EAAEK,KAAK,CAAEL,EAAErB,IAAId,EAAEmC,GAAGD,EAAEpB,GAAE,IAAKD,EAAEC,GAAE,IAAM,CAACD,EAAEqB,GAAGlC,EAAEmC,EAAEtB,KAAKsB,EAAED,GAAGC,EAAEtB,KAAK,SAASiH,EAAE3F,EAAEtB,EAAEqB,GAAG,MAAMpB,EAAE,CAAC,eAAe,eAAe,gBAAgB,IAAI,MAAMwE,KAAKnD,EAAE,CAAC,MAAMA,EAAEmD,EAAEqJ,eAAe,eAAe1H,EAAE3B,EAAEzE,EAAEqB,GAAG,OAAOoD,EAAEqI,MAAM,IAAI,QAAQ7M,EAAE,GAAGqB,EAAE,MAAM,IAAI,QAAQrB,EAAE,GAAGqB,EAAE,MAAM,IAAI,SAASrB,EAAE,GAAGqB,EAAE,MAAM,IAAI,kBAAkBrB,EAAE,GAAGqB,EAAErB,EAAE,GAAGqB,EAAE,MAAM,IAAI,MAAM,UAAK,EAAO,KAAK,KAAKrB,EAAE,GAAGqB,EAAErB,EAAE,GAAGqB,EAAErB,EAAE,GAAGqB,EAAE,MAAM,QAAQ,eAAEmD,EAAEqI,OAAO,OAAO7M","file":"js/chunk-7a7ea23a.6dd75377.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{isSome as r}from\"../core/maybe.js\";import\"../core/Logger.js\";import{property as t}from\"../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../core/accessorSupport/decorators/cast.js\";import{reader as o}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../core/accessorSupport/decorators/writer.js\";import l from\"../core/Error.js\";import{urlToObject as n,objectToQuery as p,makeAbsolute as c}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{resolve as u,create as m,reject as d}from\"../core/promiseUtils.js\";import h from\"../geometry/SpatialReference.js\";import\"../geometry.js\";import y from\"../request.js\";import f from\"./Layer.js\";import{MultiOriginJSONMixin as v}from\"../core/MultiOriginJSONSupport.js\";import{parse as g,isHostedAgolService as S,isArcGISUrl as _}from\"./support/arcgisLayerUrl.js\";import{url as j}from\"./support/commonProperties.js\";import{OperationalLayer as b}from\"./mixins/OperationalLayer.js\";import{ArcGISService as O}from\"./mixins/ArcGISService.js\";import{BlendLayer as w}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as T}from\"./mixins/CustomParametersMixin.js\";import{PortalLayer as L}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as R}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as U}from\"./mixins/ScaleRangeLayer.js\";import{HandleOwnerMixin as x}from\"../core/HandleOwner.js\";import{ArcGISCachedService as W}from\"./mixins/ArcGISCachedService.js\";import{ArcGISMapService as A}from\"./mixins/ArcGISMapService.js\";import C from\"./support/Sublayer.js\";import{SublayersOwner as I}from\"./mixins/SublayersOwner.js\";const M=[\"Canvas/World_Dark_Gray_Base\",\"Canvas/World_Dark_Gray_Reference\",\"Canvas/World_Light_Gray_Base\",\"Canvas/World_Light_Gray_Reference\",\"Elevation/World_Hillshade\",\"Elevation/World_Hillshade_Dark\",\"Ocean/World_Ocean_Base\",\"Ocean/World_Ocean_Reference\",\"Ocean_Basemap\",\"Reference/World_Boundaries_and_Places\",\"Reference/World_Boundaries_and_Places_Alternate\",\"Reference/World_Transportation\",\"World_Imagery\",\"World_Street_Map\",\"World_Topo_Map\"];let N=class extends(w(I(U(R(b(L(W(A(O(v(x(T(f))))))))))))){constructor(...e){super(...e),this.listMode=\"show\",this.isReference=null,this.operationalLayerType=\"ArcGISTiledMapServiceLayer\",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type=\"tile\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const t=r(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),u(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&h.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),i=[],a={writeSublayerStructure:!1,...s};o.forEach((e=>{const r=e.write({},a);i.push(r)}));i.some((e=>Object.keys(e).length>1))&&(r.layers=i)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>n(e).path)):null}fetchTile(e,r,t,s={}){const{signal:o,timestamp:i}=s,a=this.getTileUrl(e,r,t),l={responseType:\"image\",signal:o};return null!=i&&(l.query={_ts:s.timestamp}),y(a,l).then((e=>e.data))}getTileUrl(e,r,t){const s=!this.tilemapCache&&this.supportsBlankTile,o=p({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters}),i=this.tileServers;return`${i&&i.length?i[r%i.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${o?\"?\"+o:\"\"}`}_fetchService(e){return m(((t,s)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new l(\"tile-layer:undefined-url\",\"layer's url is not defined\");const o=g(this.parsedUrl.path);if(r(o)&&\"ImageServer\"===o.serverType)throw new l(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");y(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters},responseType:\"json\",signal:e}).then(t,s)})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=r.data,this.read(r.data,{origin:\"service\",url:this.parsedUrl}),10.1===this.version&&!S(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,r){if(!_(e))return d();const t=e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";return y(t,{query:{f:\"json\",...this.customParameters},responseType:\"json\",signal:r}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new l(\"tile-layer:version-not-available\")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\\/\\/(server\\.arcgisonline\\.com|services\\.arcgisonline\\.com|ibasemaps-api\\.arcgis\\.com)\\/arcgis\\/rest\\/services\\/([^\\/]+(\\/[^\\/]+)*)\\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,s=M.length;t<s;t++)if(r=M[t],r.toLowerCase().indexOf(e)>-1)return c(\"//static.arcgis.com/attribution/\"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\\/\\/server\\.arcgisonline\\.com/i),t=-1!==e.search(/^(?:https?:)?\\/\\/services\\.arcgisonline\\.com/i);return r||t?[e,e.replace(r?/server\\.arcgisonline/i:/services\\.arcgisonline/i,r?\"services.arcgisonline\":\"server.arcgisonline\")]:[]}};e([t({readOnly:!0,dependsOn:[\"parsedUrl\"]})],N.prototype,\"attributionDataUrl\",null),e([t({type:[\"show\",\"hide\",\"hide-children\"]})],N.prototype,\"listMode\",void 0),e([t({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,\"isReference\",void 0),e([t({readOnly:!0,type:[\"ArcGISTiledMapServiceLayer\"]})],N.prototype,\"operationalLayerType\",void 0),e([t({type:Boolean})],N.prototype,\"resampling\",void 0),e([t()],N.prototype,\"sourceJSON\",void 0),e([t({type:h})],N.prototype,\"spatialReference\",void 0),e([o(\"spatialReference\",[\"spatialReference\",\"tileInfo\"])],N.prototype,\"readSpatialReference\",null),e([t({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],N.prototype,\"path\",void 0),e([t({readOnly:!0})],N.prototype,\"sublayers\",void 0),e([a(\"sublayers\",{layers:{type:[C]}})],N.prototype,\"writeSublayers\",null),e([t({json:{read:!1,write:!1}})],N.prototype,\"popupEnabled\",void 0),e([t({dependsOn:[\"parsedUrl\"]})],N.prototype,\"tileServers\",null),e([s(\"tileServers\")],N.prototype,\"castTileServers\",null),e([t({readOnly:!0,json:{read:!1}})],N.prototype,\"type\",void 0),e([t(j)],N.prototype,\"url\",void 0),N=e([i(\"esri.layers.TileLayer\")],N);var P=N;export default P;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction n(n){return n&&\"esri.renderers.visualVariables.SizeVariable\"===n.declaredClass}function e(n){return null!=n&&!isNaN(n)&&isFinite(n)}function i(n){return n.valueExpression?\"expression\":n.field&&\"string\"==typeof n.field?\"field\":\"unknown\"}function l(n,e){const l=e||i(n),a=n.valueUnit||\"unknown\";return\"unknown\"===l?\"constant\":n.stops?\"stops\":null!=n.minSize&&null!=n.maxSize&&null!=n.minDataValue&&null!=n.maxDataValue?\"clamped-linear\":\"unknown\"===a?null!=n.minSize&&null!=n.minDataValue?n.minSize&&n.minDataValue?\"proportional\":\"additive\":\"identity\":\"real-world-size\"}export{i as getInputValueType,l as getTransformationType,n as isSizeVariable,e as isValidNumber};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{clone as t}from\"../../core/lang.js\";import i from\"../../core/Error.js\";import{constant as e}from\"../../core/arrayUtils.js\";import a from\"../../request.js\";class l{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability=\"unknown\",this.byteSize=40}getAvailability(t,i){if(\"unknown\"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?\"unknown\":o[l]&1<<a?\"available\":\"unavailable\"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let i=0;i<t.length;i++){const e=i%8;t[i]?(l=!1,n[r]|=1<<e):a=!1,7===e&&++r}l?this._allAvailability=\"unavailable\":a?this._allAvailability=\"available\":(this._allAvailability=\"unknown\",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)}static fromDefinition(t,o){const r=t.service.request||a,{row:s,col:h,width:c,height:m}=t,d={query:{f:\"json\"}};return o=o?{...d,...o}:d,r(n(t),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:s,left:h,width:c,height:m},valid:!0,data:e(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new i(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:s,left:h,width:c,height:m}});return l.fromJSON(t)}))}static fromJSON(i){l.validateJSON(i);const e=new l;return e.location=Object.freeze(t(i.location)),e._updateFromData(i.data),Object.freeze(e)}static validateJSON(t){if(!t||!t.location)throw new i(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new i(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new i(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new i(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new i(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function o(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(\"vector-tile\"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else{const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}const e=t.service.query;return e&&(i=`${i}?${e}`),i}export default l;export{l as Tilemap,o as tilemapDefinitionId,n as tilemapDefinitionUrl};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import t from\"../../core/Logger.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import{cast as l}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"../../core/Error.js\";import{objectToQuery as a}from\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import o from\"../../core/PooledArray.js\";import{reject as n,resolve as h,create as c,onAbort as p,createAbortError as m,isAbortError as u,createAbortController as f,isAborted as v}from\"../../core/promiseUtils.js\";import{waitTicks as y}from\"../../core/scheduling.js\";import d from\"../../core/Accessor.js\";import _ from\"../../request.js\";import b from\"../../core/Handles.js\";import{init as g}from\"../../core/watchUtils.js\";import w from\"../../core/LRUCache.js\";import{tilemapDefinitionId as T,Tilemap as j}from\"./Tilemap.js\";var z;const A=t.getLogger(\"esri.layers.support.TilemapCache\");let L=z=class extends d{constructor(e){super(e),this._handles=new b,this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=_,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new w(this.cacheByteSize),this._handles.add([this.watch([\"layer.parsedUrl\",\"layer.tileServers?\"],(()=>this._initializeTilemapDefinition())),g(this,\"layer.tileInfo.lods\",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}castLevels(e){return e<=2?(A.error(\"Minimum levels for Tilemap is 3, but got \",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,l){if(!this._availableLevels[e])return n(new s(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const r=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,r);if(a)return h(a);const o=l&&l.signal;return l={...l,signal:null},c(((e,t)=>{p(o,(()=>t(m())));const i=T(r);let s=this._pendingTilemapRequests[i];if(!s){s=j.fromDefinition(r,l).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=s,s.then(e,e)}s.then(e,t)}))}getAvailability(e,t,i){if(!this._availableLevels[e])return\"unavailable\";const l=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return l?l.getAvailability(t,i):\"unknown\"}getAvailabilityUpsample(e,t,i,l){l.level=e,l.row=t,l.col=i;const r=this.layer.tileInfo;for(r.updateTileInfo(l);;){const e=this.getAvailability(l.level,l.row,l.col);if(\"unavailable\"!==e)return e;if(!r.upsampleTile(l))return\"unavailable\"}}fetchAvailability(e,t,i,l){return this._availableLevels[e]?this.fetchTilemap(e,t,i,l).catch((e=>e)).then((l=>{if(l instanceof j){const r=l.getAvailability(t,i);return\"unavailable\"===r?n(new s(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):r}if(u(l))throw l;return\"unknown\"})):n(new s(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,l,r){l.level=e,l.row=t,l.col=i;const s=this.layer.tileInfo;s.updateTileInfo(l);const a=this.fetchAvailability(e,t,i,r).catch((e=>{if(u(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l);throw e}));return this._fetchAvailabilityUpsamplePrefetch(l.id,e,t,i,r,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,l,r,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this._handles.has(a))return;const o=f();s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const h={remove(){n||(n=!0,o.abort())}};if(this._handles.add(h,a),await y(10,o.signal).catch((()=>{})),n||(n=!0,this._handles.remove(a)),v(o))return;const c={id:e,level:t,row:i,col:l},p={...r,signal:o.signal},m=this.layer.tileInfo;for(let e=0;z._prefetches.length<z._maxPrefetch&&m.upsampleTile(c);++e){const e=this.fetchAvailability(c.level,c.row,c.col,p);z._prefetches.push(e);const t=()=>{z._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?a(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,l){l.level=e,l.row=t-t%this.size,l.col=i-i%this.size;const r=T(l);return this._tilemapCache.get(r)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,l)=>!!e._tilemapFromCache(t,i,l,e._tmpTilemapDefinition)}}};L._maxPrefetch=4,L._prefetches=new o({initialSize:z._maxPrefetch}),e([i({constructOnly:!0,type:Number})],L.prototype,\"levels\",void 0),e([l(\"levels\")],L.prototype,\"castLevels\",null),e([i({readOnly:!0,dependsOn:[\"levels\"],type:Number})],L.prototype,\"size\",null),e([i({constructOnly:!0,type:Number})],L.prototype,\"cacheByteSize\",void 0),e([i({constructOnly:!0})],L.prototype,\"layer\",void 0),e([i({constructOnly:!0})],L.prototype,\"request\",void 0),L=z=e([r(\"esri.layers.support.TilemapCache\")],L);export{L as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{earth as e}from\"../../geometry/support/Ellipsoid.js\";import{convertUnit as s,lengthToDegrees as t}from\"../../core/unitUtils.js\";const m={inches:s(1,\"meters\",\"inches\"),feet:s(1,\"meters\",\"feet\"),\"us-feet\":s(1,\"meters\",\"us-feet\"),yards:s(1,\"meters\",\"yards\"),miles:s(1,\"meters\",\"miles\"),\"nautical-miles\":s(1,\"meters\",\"nautical-miles\"),millimeters:s(1,\"meters\",\"millimeters\"),centimeters:s(1,\"meters\",\"centimeters\"),decimeters:s(1,\"meters\",\"decimeters\"),meters:s(1,\"meters\",\"meters\"),kilometers:s(1,\"meters\",\"kilometers\"),\"decimal-degrees\":1/t(1,\"meters\",e.radius)};export{m as meterIn};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"./TileInfo.js\";const r={type:e,json:{origins:{service:{read:{source:[\"tileInfo\",\"minScale\",\"maxScale\",\"minLOD\",\"maxLOD\"],reader:n}}}}};function n(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?e.fromJSON(r):e.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return e.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return e.fromJSON(r)}export{n as readServiceTileInfo,r as serviceTileInfoProperty};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import i from\"../../geometry/SpatialReference.js\";import\"../../geometry.js\";import{serviceTileInfoProperty as p}from\"../support/serviceTileInfoProperty.js\";import{TilemapCache as s}from\"../support/TilemapCache.js\";const a=a=>{let l=class extends a{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf(\"Tilemap\")>-1?new s({layer:this}):null}};return e([r({json:{read:{source:\"copyrightText\"}}})],l.prototype,\"copyright\",void 0),e([r()],l.prototype,\"minScale\",void 0),e([o(\"service\",\"minScale\")],l.prototype,\"readMinScale\",null),e([r()],l.prototype,\"maxScale\",void 0),e([o(\"service\",\"maxScale\")],l.prototype,\"readMaxScale\",null),e([r({type:i})],l.prototype,\"spatialReference\",void 0),e([r({readOnly:!0,dependsOn:[\"version\"]})],l.prototype,\"supportsBlankTile\",null),e([r(p)],l.prototype,\"tileInfo\",void 0),e([r()],l.prototype,\"tilemapCache\",void 0),e([o(\"service\",\"tilemapCache\",[\"capabilities\"])],l.prototype,\"readTilemapCache\",null),e([r()],l.prototype,\"version\",void 0),l=e([t(\"esri.layers.mixins.ArcGISCachedService\")],l),l};export{a as ArcGISCachedService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{neverReached as e}from\"../../../core/compilerUtils.js\";import{isSome as a,isNone as r}from\"../../../core/maybe.js\";import i from\"../../../core/Logger.js\";import t from\"../../../Color.js\";import n from\"../../../Graphic.js\";import{meterIn as s}from\"../../support/lengthUtils.js\";import{isSizeVariable as o,isValidNumber as l}from\"./sizeVariableUtils.js\";const c=i.getLogger(\"esri.renderers.visualVariables.support.visualVariableUtils\"),u=new n,f=Math.PI,p=/^\\s*(return\\s+)?\\$view\\.scale\\s*(;)?\\s*$/i;function d(e,r,i){const n=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter((e=>\"color\"===e.type))[0]:e;if(!n)return;if(\"esri.renderers.visualVariables.ColorVariable\"!==n.declaredClass)return void c.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable\");const s=\"number\"==typeof r,o=s?null:r,l=o&&o.attributes;let u=s?r:null;const f=n.field,{ipData:p,hasExpression:d}=n.cache;let v=n.cache.compiledFunc;if(!f&&!d){const e=n.stops;return e&&e[0]&&e[0].color}if(\"number\"!=typeof u)if(d){if(!a(i)||!a(i.arcade))return void c.error(\"Use of arcade expressions requires an arcade context\");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},r=i.arcade.arcadeUtils,t=r.getViewInfo(e),s=r.createExecContext(o,t);if(!v){const e=r.createSyntaxTree(n.valueExpression);v=r.createFunction(e),n.cache.compiledFunc=v}u=r.executeFunction(v,s)}else l&&(u=l[f]);const b=n.normalizationField,h=l?parseFloat(l[b]):void 0;if(null!=u&&(!b||s||!isNaN(h)&&0!==h)){isNaN(h)||s||(u/=h);const e=g(u,p);if(e){const r=e[0],s=e[1],o=r===s?n.stops[r].color:t.blendColors(n.stops[r].color,n.stops[s].color,e[2],a(i)?i.color:void 0);return new t(o)}}}function v(e,a,i){const t=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter((e=>\"opacity\"===e.type))[0]:e;if(!t)return;if(\"esri.renderers.visualVariables.OpacityVariable\"!==t.declaredClass)return void c.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable\");const n=\"number\"==typeof a,s=n?null:a,o=s&&s.attributes;let l=n?a:null;const u=t.field,{ipData:f,hasExpression:p}=t.cache;let d=t.cache.compiledFunc;if(!u&&!p){const e=t.stops;return e&&e[0]&&e[0].opacity}if(\"number\"!=typeof l)if(p){if(r(i)||r(i.arcade))return void c.error(\"Use of arcade expressions requires an arcade context\");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},a=i.arcade.arcadeUtils,n=a.getViewInfo(e),o=a.createExecContext(s,n);if(!d){const e=a.createSyntaxTree(t.valueExpression);d=a.createFunction(e),t.cache.compiledFunc=d}l=a.executeFunction(d,o)}else o&&(l=o[u]);const v=t.normalizationField,b=o?parseFloat(o[v]):void 0;if(null!=l&&(!v||n||!isNaN(b)&&0!==b)){isNaN(b)||n||(l/=b);const e=g(l,f);if(e){const a=e[0],r=e[1];if(a===r)return t.stops[a].opacity;{const i=t.stops[a].opacity;return i+(t.stops[r].opacity-i)*e[2]}}}}function b(e,a,i){const t=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter((e=>\"rotation\"===e.type))[0]:e;if(!t)return;if(\"esri.renderers.visualVariables.RotationVariable\"!==t.declaredClass)return void c.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable\");const n=t.axis||\"heading\",s=\"heading\"===n&&\"arithmetic\"===t.rotationType?90:0,o=\"heading\"===n&&\"arithmetic\"===t.rotationType?-1:1,l=\"number\"==typeof a?null:a,u=l&&l.attributes,f=t.field,{hasExpression:p}=t.cache;let d=t.cache.compiledFunc,v=0;if(!f&&!p)return v;if(p){if(r(i)||r(i.arcade))return void c.error(\"Use of arcade expressions requires an arcade context\");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},a=i.arcade.arcadeUtils,n=a.getViewInfo(e),s=a.createExecContext(l,n);if(!d){const e=a.createSyntaxTree(t.valueExpression);d=a.createFunction(e),t.cache.compiledFunc=d}v=a.executeFunction(d,s)}else u&&(v=u[f]||0);return v=\"number\"!=typeof v||isNaN(v)?null:s+o*v,v}function h(e,i,t){const n=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter((e=>\"size\"===e.type))[0]:e;if(!n)return;if(\"esri.renderers.visualVariables.SizeVariable\"!==n.declaredClass)return void c.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable\");const s=x(function(e,i,t){const n=\"number\"==typeof i,s=n?null:i,o=s&&s.attributes;let u=n?i:null;const{isScaleDriven:f}=e.cache;let p=e.cache.compiledFunc;if(f){const r=a(t)?t.scale:void 0,i=a(t)?t.view:void 0;u=null==r||\"3d\"===i?function(e){let a=null,r=null;const i=e.stops;return i?(a=i[0].value,r=i[i.length-1].value):(a=e.minDataValue||0,r=e.maxDataValue||0),(a+r)/2}(e):r}else if(!n)switch(e.inputValueType){case\"expression\":{if(r(t)||r(t.arcade))return void c.error(\"Use of arcade expressions requires an arcade context\");const a={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},i=t.arcade.arcadeUtils,n=i.getViewInfo(a),o=i.createExecContext(s,n);if(!p){const a=i.createSyntaxTree(e.valueExpression);p=i.createFunction(a),e.cache.compiledFunc=p}u=i.executeFunction(p,o);break}case\"field\":o&&(u=o[e.field]);break;case\"unknown\":u=null}if(!l(u))return null;if(n||!e.normalizationField)return u;const d=o?parseFloat(o[e.normalizationField]):null;return l(d)&&0!==d?u/d:null}(n,i,t),n,i,t,n.cache.ipData);return null==s||isNaN(s)?0:s}function m(e,a,r){return null==e?null:o(e)?h(e,a,r):l(e)?e:null}function V(e,a,r){return l(r)&&e>r?r:l(a)&&e<a?a:e}function x(e,r,i,t,n){switch(r.transformationType){case\"additive\":return function(e,a,r,i){return e+(m(a.minSize,r,i)||a.minDataValue)}(e,r,i,t);case\"constant\":return function(e,a,r){const i=e.stops;let t=i&&i.length&&i[0].size;return null==t&&(t=e.minSize),m(t,a,r)}(r,i,t);case\"clamped-linear\":return function(e,r,i,t){const n=(e-r.minDataValue)/(r.maxDataValue-r.minDataValue),s=m(r.minSize,i,t),o=m(r.maxSize,i,t),l=a(t)?t.shape:void 0;if(e<=r.minDataValue)return s;if(e>=r.maxDataValue)return o;if(\"area\"===r.scaleBy&&l){const e=\"circle\"===l,a=e?f*Math.pow(s/2,2):s*s,r=a+n*((e?f*Math.pow(o/2,2):o*o)-a);return e?2*Math.sqrt(r/f):Math.sqrt(r)}return s+n*(o-s)}(e,r,i,t);case\"proportional\":return function(e,r,i,t){const n=a(t)?t.shape:void 0,s=e/r.minDataValue,o=m(r.minSize,i,t),l=m(r.maxSize,i,t);let c=null;return c=\"circle\"===n?2*Math.sqrt(s*Math.pow(o/2,2)):\"square\"===n||\"diamond\"===n||\"image\"===n?Math.sqrt(s*Math.pow(o,2)):s*o,V(c,o,l)}(e,r,i,t);case\"stops\":return function(e,a,r,i,t){const[n,s,o]=g(e,t);if(n===s)return m(a.stops[n].size,r,i);{const e=m(a.stops[n].size,r,i);return e+(m(a.stops[s].size,r,i)-e)*o}}(e,r,i,t,n);case\"real-world-size\":return function(e,r,i,t){const n=(a(t)&&t.resolution?t.resolution:1)*s[r.valueUnit],o=m(r.minSize,i,t),l=m(r.maxSize,i,t),{valueRepresentation:c}=r;let u=null;return u=\"area\"===c?2*Math.sqrt(e/f)/n:\"radius\"===c||\"distance\"===c?2*e/n:e/n,V(u,o,l)}(e,r,i,t);case\"identity\":return e;case\"unknown\":return null}}function w(e,a,r){const{isScaleDriven:i}=e.cache;if(!(i&&\"3d\"===r||a))return null;const t={scale:a,view:r};let n=m(e.minSize,u,t),s=m(e.maxSize,u,t);if(null!=n||null!=s){if(n>s){const e=s;s=n,n=e}return{minSize:n,maxSize:s}}}function y(e,a,r){if(!e.visualVariables)return;const i=[],t=[],n=[],s=[],o=[];for(const a of e.visualVariables)switch(a.type){case\"color\":t.push(a);break;case\"opacity\":n.push(a);break;case\"rotation\":o.push(a);break;case\"size\":s.push(a)}return t.forEach((e=>{const t=d(e,a,r);i.push({variable:e,value:t})})),n.forEach((e=>{const t=v(e,a,r);i.push({variable:e,value:t})})),o.forEach((e=>{const t=b(e,a,r);i.push({variable:e,value:t})})),s.forEach((e=>{const t=h(e,a,r);i.push({variable:e,value:t})})),i.filter((e=>null!=e.value))}function g(e,a){if(!a)return;let r=0,i=a.length-1;return a.some(((a,t)=>e<a?(i=t,!0):(r=t,!1))),[r,i,(e-a[r])/(a[i]-a[r])]}function z(a,r,i){const t=[\"proportional\",\"proportional\",\"proportional\"];for(const n of a){const a=n.useSymbolValue?\"symbol-value\":h(n,r,i);switch(n.axis){case\"width\":t[0]=a;break;case\"depth\":t[1]=a;break;case\"height\":t[2]=a;break;case\"width-and-depth\":t[0]=a,t[1]=a;break;case\"all\":case void 0:case null:t[0]=a,t[1]=a,t[2]=a;break;default:e(n.axis)}}return t}export{z as getAllSizes,d as getColor,v as getOpacity,b as getRotationAngle,h as getSize,x as getSizeForValue,m as getSizeFromNumberOrVariable,w as getSizeRangeAtScale,y as getVisualVariableValues,p as viewScaleRE};\n"],"sourceRoot":""}